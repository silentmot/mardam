function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{C3ze:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var r=i("2JTG"),n=i("Fikd"),s=i("jtS9"),a=i("GJmQ"),o=i("fXoL"),c=i("tyNb"),l=i("0IaG"),u=i("XiUz"),p=i("ofXK"),v=i("EkSr"),d=i("gpoT"),f=i("znSr"),m=i("CREh"),h=i("NhFE"),g=i("bTqV"),y=i("NFeN"),x=function(e){return{headerSmallSize:e}};function b(e,t){if(1&e){var i=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"div",8),o["\u0275\u0275text"](1,"\n    "),o["\u0275\u0275elementStart"](2,"app-list-grid-options",9),o["\u0275\u0275listener"]("openForm",(function(){return o["\u0275\u0275restoreView"](i),o["\u0275\u0275nextContext"]().openForm({open:!0})})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](3,"\n  "),o["\u0275\u0275elementEnd"]()}if(2&e){var r=o["\u0275\u0275nextContext"]();o["\u0275\u0275property"]("ngClass",o["\u0275\u0275pureFunction1"](4,x,r.headerSmallSize)),o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("listOptions",r.listOptions)("showTitle",r.showTitle)("service",r.service)}}function L(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"div",10),o["\u0275\u0275text"](1,"\n    "),o["\u0275\u0275element"](2,"app-pagination",11),o["\u0275\u0275text"](3,"\n  "),o["\u0275\u0275elementEnd"]()),2&e){var i=o["\u0275\u0275nextContext"]();o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("service",i.service)("options",i.listOptions)}}function O(e,t){if(1&e){var i=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"div",12),o["\u0275\u0275text"](1,"\n  "),o["\u0275\u0275elementStart"](2,"button",13),o["\u0275\u0275listener"]("click",(function(){return o["\u0275\u0275restoreView"](i),o["\u0275\u0275nextContext"]().service.loadDummyData()})),o["\u0275\u0275text"](3,"\n    "),o["\u0275\u0275elementStart"](4,"mat-icon",14),o["\u0275\u0275text"](5,"\n      battery_unknown\n    "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](6,"\n  "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](7,"\n"),o["\u0275\u0275elementEnd"]()}}var S=function(){var e=function(){function e(t,i,r,n,s){_classCallCheck(this,e),this.service=t,this.utilitiesService=i,this.router=r,this.activatedRoute=n,this.dialog=s,this.alive=!0,this.appListGridOptions=!0,this.showTitle=!0,this.headerSmallSize=!1,this.showBreadcrumb=!0,this.listOptions={itemsPerPage:[10,20,50,100],archive:!0,delete:!1,add:!0,addAction:!0,edit:!0,view:!0,exportList:!1,importList:!1,clone:!0,groups:!1,hoverData:{status:!1},selectable:!1,activate:!1,deactivate:!1,archivedList:!1,search:!0},this.params={queryParams:{page:1,perPage:this.listOptions.itemsPerPage[0]}}}return _createClass(e,[{key:"openForm",value:function(e){e.open&&(e.id?this.openDialog(this.formComponentInstance,{id:e.id}):this.openDialog(this.formComponentInstance))}},{key:"openDialog",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"60%";this.dialog.open(e,{width:r,panelClass:"scrollableDialog",data:t||{},disableClose:i})}},{key:"ngOnInit",value:function(){var e=this;n.a.calcListHeight(),n.a.pushResize(),this.activatedRoute.data.pipe(Object(a.a)((function(){return e.alive}))).subscribe((function(t){return t&&!t.isArchive?(e.params={queryParams:e.refactorFilters({page:1})},e.service.startAutoLoad(e.params).then((function(){var t=e.service.featureProps;t.length&&(e.columns=t),e.paginationInit()}))):(e.listOptions.archivedList=!0,e.params={queryParams:e.refactorFilters({page:1})},e.service.startAutoLoad(e.params,!0).then((function(){var t=e.service.featureProps;t.length&&(e.columns=t),e.paginationInit()})))})),this.service.loadSelectLists("list"),this.service.setModulePermissions(),this.permissionsUpdateSubscription()}},{key:"paginationInit",value:function(){var e=this;this.utilitiesService.filtersObservable$.pipe(Object(a.a)((function(){return e.alive}))).subscribe((function(t){if(t){t=e.service.refactorFiltersBeforeQueryParams(t);for(var i={},r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];Array.isArray(t[s])?i[s+"[]"]=t[s]:i[s]=t[s],t[s]||delete i[s]}return e.params.queryParams=e.refactorFilters(i),e.resetList()}})),this.utilitiesService.sortObservable$.pipe(Object(a.a)((function(){return e.alive}))).subscribe((function(t){if(t.colName)return e.params.queryParams.sort=t.colName,e.params.queryParams.direction=t.dir?"asc":"desc",e.resetList()})),this.utilitiesService.countObservable$.pipe(Object(a.a)((function(){return e.alive}))).subscribe((function(t){if(t)return e.params.queryParams.page=1,e.params.queryParams.perPage=+t,e.loadResources()})),this.service.updateResources.pipe(Object(a.a)((function(){return e.alive}))).subscribe((function(){return e.loadResources()})),this.service.appendResources$.pipe(Object(a.a)((function(){return e.alive}))).subscribe((function(){return e.loadAppendResources()})),this.utilitiesService.paginateObservable$.pipe(Object(a.a)((function(){return e.alive}))).subscribe((function(t){if(t)return e.params.queryParams.page=t,e.loadResources()})),this.utilitiesService.paginateInfiniteObservable$.pipe(Object(a.a)((function(){return e.alive}))).subscribe((function(t){if(t.page&&(t.cid===e.service.cid||t.customCid===e.service.customCid))return t.serviceUniqueIdentifier&&t.serviceUniqueIdentifier!==e.service.customData.serviceUniqueIdentifier?void 0:(e.params.queryParams.page=t.page,e.loadInfiniteResources())}))}},{key:"resetList",value:function(){this.params.queryParams.page=1,this.utilitiesService.navigate(this.params.queryParams.page)}},{key:"loadResources",value:function(){return this.listOptions.archivedList?this.service.startAutoLoad(this.params,!0):this.service.startAutoLoad(this.params)}},{key:"loadAppendResources",value:function(){var e=Object.assign({},this.params);return e.queryParams.page=1,this.service.startAutoLoad(e,!!this.listOptions.archivedList,!0,!0)}},{key:"loadInfiniteResources",value:function(){return this.service.startAutoLoad(this.params,!!this.listOptions.archivedList,!0)}},{key:"ngOnDestroy",value:function(){this.alive=!1,this.service.clearSelectedList(),this.utilitiesService.setFilters({}),this.utilitiesService.sortListBy({})}},{key:"permissionsUpdateSubscription",value:function(){var e=this;this.service.permissionsService.permissionsUpdated.pipe(Object(a.a)((function(){return e.alive}))).subscribe((function(){e.service.setModulePermissions(),e.unAuthRedirect()}))}},{key:"unAuthRedirect",value:function(){var e=this,t=this.activatedRoute.snapshot.data.permissionsKeys;t&&t.length&&(t.every((function(t){return console.log(e.service.permissionsService.getPermissions(t.key)),e.service.permissionsService.getPermissions(t.key)}))||this.router.navigateByUrl("/401",{skipLocationChange:!0}))}},{key:"refactorFilters",value:function(e){return this.service.refactorFilters(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](r.a),o["\u0275\u0275directiveInject"](s.a),o["\u0275\u0275directiveInject"](c.d),o["\u0275\u0275directiveInject"](c.a),o["\u0275\u0275directiveInject"](l.b))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["app-core-list"]],decls:23,vars:9,consts:[["fxFlex","","fxLayout","column",1,"core-list"],["fxFlex","","fxLayout","","class","page_heading list-grid-options","id","tableOptions",3,"ngClass",4,"ngIf"],["fxFlex","","fxLayout","row",1,"filter-section"],["fxFlex","100",3,"service","listOptions","params"],["fxFlex","","fxLayout","row","fxLayoutGap","20px",1,"container","list-grid-container"],[3,"columns","options","service","openForm"],["fxFlex","","fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end center","class","container list-grid-pagination",4,"ngIf"],["class","dummyDataLoader","id","dummyDataLoader",4,"ngIf"],["fxFlex","","fxLayout","","id","tableOptions",1,"page_heading","list-grid-options",3,"ngClass"],["fxFlex","",3,"listOptions","showTitle","service","openForm"],["fxFlex","","fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end center",1,"container","list-grid-pagination"],[3,"service","options"],["id","dummyDataLoader",1,"dummyDataLoader"],["mat-icon-button","",3,"click"],["color","warn"]],template:function(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"div",0),o["\u0275\u0275text"](1,"\n  "),o["\u0275\u0275template"](2,b,4,6,"div",1),o["\u0275\u0275text"](3,"\n  "),o["\u0275\u0275elementStart"](4,"div",2),o["\u0275\u0275text"](5,"\n    "),o["\u0275\u0275element"](6,"app-list-multiple-operations",3),o["\u0275\u0275text"](7,"\n  "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](8,"\n  "),o["\u0275\u0275elementStart"](9,"div",4),o["\u0275\u0275text"](10,"\n    "),o["\u0275\u0275elementStart"](11,"app-list-grid",5),o["\u0275\u0275listener"]("openForm",(function(e){return t.openForm(e)})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](12,"\n  "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](13,"\n  "),o["\u0275\u0275template"](14,L,4,2,"div",6),o["\u0275\u0275text"](15,"\n  "),o["\u0275\u0275text"](16,"\n  "),o["\u0275\u0275text"](17,"\n  "),o["\u0275\u0275text"](18,"\n"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](19,"\n\n"),o["\u0275\u0275template"](20,O,8,0,"div",7),o["\u0275\u0275text"](21,"\n"),o["\u0275\u0275text"](22,"\n")),2&e&&(o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("ngIf",t.appListGridOptions),o["\u0275\u0275advance"](4),o["\u0275\u0275property"]("service",t.service)("listOptions",t.listOptions)("params",t.params),o["\u0275\u0275advance"](5),o["\u0275\u0275property"]("columns",t.columns)("options",t.listOptions)("service",t.service),o["\u0275\u0275advance"](3),o["\u0275\u0275property"]("ngIf",!(null!=t.listOptions&&t.listOptions.infiniteScrolling)),o["\u0275\u0275advance"](6),o["\u0275\u0275property"]("ngIf",t.service.dummyDataLoader))},directives:[u.b,u.f,p.t,v.a,u.g,d.a,p.q,f.a,m.a,u.e,h.a,g.b,y.a],styles:[""]}),e}()}}]);